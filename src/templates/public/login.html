{% extends 'public/layout.html' %} 
{% block body %}
<link rel="stylesheet" type="text/css" href="{{ asset_url }}/styles/public/main.css" />
<link rel="stylesheet" type="text/css" href="{{ asset_url }}/styles/public/login.css" />
<input type="hidden" id="auth_hash" value="{{ auth_hash }}">

<section class="main bg-dark">
    <div class="main__top">
        <a class="main__logo" href="{{ site_url }}">
            <img alt="icon" src="{{ asset_url }}/images/icon-64x64.png">
            <div>Trivial Security</div>
        </a>
        <div class="main__links">
            <a id="home-link" href="{{ site_url }}">Homepage</a>
        </div>
        <div class="main__links">
            <a id="app-link" href="{{ app_url }}/dashboard">Dashboard</a>
        </div>
    </div>
    <div class="main__jumbo">
        <div class="main__jumbo-title">
            Multi-factor Authentication
        </div>
    </div>
    <div class="ChooseMfa__formContainer">
        <div class="Card__card LoginCard__card choose-mfa">
            <h1 class="LoginCard__header">
                Authentication Method
            </h1>
            <div class="Card__card--inner">
                <h2 class="ChooseMfa__subheader">
                    Choose one of the following:
                </h2>
                <fieldset class="ChooseMfa__fieldset">
                    <label class="ChooseMfa__label totp">
                        <input name="mfaType" type="radio" value="totp">
                        <img src="{{ asset_url }}/images/icon-totp.svg" class="ChooseMfa__factorIconWrapper ChooseMfa__iconWrapper" alt>
                        Software/App Verification Code
                    </label>
                </fieldset>
                <fieldset class="ChooseMfa__fieldset">
                    <label class="ChooseMfa__label webauthn">
                        <input name="mfaType" type="radio" value="webauthn">
                        <img src="{{ asset_url }}/images/icon-security-key.svg" class="ChooseMfa__factorIconWrapper ChooseMfa__iconWrapper">
                        Hardware Security Key
                    </label>
                </fieldset>
                <button id="choose-mfa" type="button" class="LoginActionButton__button wait_recaptcha">Next</button>
            </div>
        </div>
        <div class="Card__card LoginCard__card confirm-webauthn hide">
            <h1 class="LoginCard__header">
                Attempting Verification..
            </h1>
            <div>
                <div class="success-checkmark_off hide">
                    <div class="check-icon">
                        <span class="icon-line line-tip"></span>
                        <span class="icon-line line-long"></span>
                        <div class="icon-circle"></div>
                        <div class="icon-fix"></div>
                    </div>
                </div>
                <h2 class="ChooseMfa__subheader">
                    Verify using your Hardware Security Key
                </h2>
                <img src="{{ asset_url }}/images/icon-security-key.svg" class="ChooseMfa__factorIconWrapper ChooseMfa__iconWrapper">
                <p class="ChooseMfa__parra">
                    Touch sensor
                </p>
                <button id="retry-webauthn" type="button" class="LoginActionButton__button wait_recaptcha">Retry</button>
            </div>
        </div>
        <div class="Card__card LoginCard__card verify-totp hide">
            <h1 class="LoginCard__header">
                TOTP Verification
            </h1>
            <div>
                <div class="success-checkmark_off hide">
                    <div class="check-icon">
                        <span class="icon-line line-tip"></span>
                        <span class="icon-line line-long"></span>
                        <div class="icon-circle"></div>
                        <div class="icon-fix"></div>
                    </div>
                </div>
                <div id="totp-message" class="ChooseMfa__parra">
                    {{ totp_message }}
                </div>
                <fieldset class="totp__fieldset">
                    <input type="number" name="totpcode[]" class="verify-code" placeholder="?" min="0" max="9" required />
                    <input type="number" name="totpcode[]" class="verify-code" placeholder="?" min="0" max="9" required />
                    <input type="number" name="totpcode[]" class="verify-code" placeholder="?" min="0" max="9" required />
                    <input type="number" name="totpcode[]" class="verify-code" placeholder="?" min="0" max="9" required />
                    <input type="number" name="totpcode[]" class="verify-code" placeholder="?" min="0" max="9" required />
                    <input type="number" name="totpcode[]" class="verify-code" placeholder="?" min="0" max="9" required />
                </fieldset>
                <button id="verify-totp" type="button" class="LoginActionButton__button wait_recaptcha verify-code">Verify Code</button>
            </div>
        </div>
    </div>
</section>
<div class="footer__spacer"></div>
<div class="footer">
    <div>
        Â© 2021 Trivial Security. All Rights Reserved.<br>
        <a href="/terms.html">Terms of Service</a> | <a href="/privacy.html">Privacy Policy</a>
    </div>
</div>
{% endblock %}