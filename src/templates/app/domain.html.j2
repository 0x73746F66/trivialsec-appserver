{% extends 'app/layout.html.j2' %} 
{% block body %}
<link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/app/domain.css')|autoversion }}">
<script type=text/javascript>
trackingIds = [{% for job in job_runs %}'{{ job.tracking_id }}',{% endfor %}];
</script>
{% include 'app/domain-banner.html.j2' %}
<div class="domain-container">
    <div class="container-tabs">
        <a href="/app/domain/{{ domain.domain_id }}" class="active">Details</a>
        <a href="/app/domain/{{ domain.domain_id }}/jobs">Jobs <span class="counter">{{ jobs_count }}</span></a>
        <a href="/app/domain/{{ domain.domain_id }}/inventory">Inventory <span class="counter">{{ programs_count }}</span></a>
        <a href="/app/domain/{{ domain.domain_id }}/subdomains">Subdomains <span class="counter">{{ subdomains_count }}</span></a>
        <a href="/app/domain/{{ domain.domain_id }}/findings">Findings <span class="counter">{{ findings_count }}</span></a>
    </div>
    <div class="domain-body">
        <div class="fields" id="knownips-list"{% if not known_ips %} style="display: none;"{% endif %}>
            <div class="fields-row">
                <div class="input-column column">
                    <div class="knownips-list">
                        <table>
                            <thead>
                            <tr>
                                <th>IP Address</th>
                                <th>Source</th>
                                <th>Last Checked</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for known_ip in known_ips %}
                            <tr data-knownip-id="{{ known_ip.known_ip_id }}">
                                <td>{{ known_ip.ip_address }}</td>
                                <td>{{ known_ip.source }}</td>
                                <td><time datetime="{{ known_ip.updated_at }}"></time></td>
                            </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    
                </div>
            </div>
        </div>
        <div class="fields" id="dnsrecords-list"{% if not dns_records %} style="display: none;"{% endif %}>
            <div class="fields-row">
                <div class="input-column column">
                    <div class="dnsrecords-list">
                        <table>
                            <thead>
                            <tr>
                                <th>DNS</th>
                                <th width="200">Last Checked</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for dns_record in dns_records %}
                            <tr data-dnsrecord-id="{{ dns_record.dns_record_id }}">
                                <td>{{ dns_record.raw }}</td>
                                <td><time datetime="{{ dns_record.last_checked }}"></time></td>
                            </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    
                </div>
            </div>
        </div>
        {% if domain.http_headers %}{% set http_headers = domain.http_headers.data | from_json %}
        <div class="fields" id="httpheaders-list">
            <div class="fields-row">
                <div class="input-column column">
                    <div class="httpheaders-list">
                        <table>
                            <thead>
                            <tr>
                                <th colspan="2">HTTP Headers</th>
                            </tr>
                            </thead>
                            <tbody>
                            {% for header, value in http_headers.items() %}
                            <tr>
                                <td>{{ header }}</td>
                                <td>{{ value }}</td>
                            </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        {% endif %}
    </div>
</div>
<script type=text/javascript src="{{url_for('static', filename='js/vendor/chart.min.js') }}"></script>
<script type=text/javascript src="{{url_for('static', filename='js/app/domain.js')|autoversion }}"></script>
{% endblock %}